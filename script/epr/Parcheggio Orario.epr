{"idRate":0,"name":"Parcheggio Orario","description":"Parcheggio Orario","script":"const TipologiaVeicolo = {\n  AUTO_PICCOLA: 'Auto Piccola',\n  AUTO_MEDIA: 'Auto Media',\n  AUTO_GRANDE: 'Auto Grande',\n  SUV_LUSSO: 'Suv/Lusso',\n  FURGONE: 'Furgone',\n  MOTO: 'Moto',\n  SCOOTER: 'Scooter',\n};\n\nconst COSTO_ORARIO_FASCIA1 = {\n  [TipologiaVeicolo.AUTO_PICCOLA]: parseFloat(F1_ORA_APIC),\n  [TipologiaVeicolo.AUTO_MEDIA]: parseFloat(F1_ORA_AMED),\n  [TipologiaVeicolo.AUTO_GRANDE]: parseFloat(F1_ORA_AGRA),\n  [TipologiaVeicolo.SUV_LUSSO]: parseFloat(F1_ORA_ASUV),\n  [TipologiaVeicolo.FURGONE]: parseFloat(F1_ORA_FURG),\n  [TipologiaVeicolo.MOTO]: parseFloat(F1_ORA_MOTO),\n  [TipologiaVeicolo.SCOOTER]: parseFloat(F1_ORA_SCOT),\n};\n\nconst LIMITE_FASCIA1 = {\n  [TipologiaVeicolo.AUTO_PICCOLA]: parseFloat(F1_MAX_APIC),\n  [TipologiaVeicolo.AUTO_MEDIA]: parseFloat(F1_MAX_AMED),\n  [TipologiaVeicolo.AUTO_GRANDE]: parseFloat(F1_MAX_AGRA),\n  [TipologiaVeicolo.SUV_LUSSO]: parseFloat(F1_MAX_ASUV),\n  [TipologiaVeicolo.FURGONE]: parseFloat(F1_MAX_FURG),\n  [TipologiaVeicolo.MOTO]: parseFloat(F1_MAX_MOTO),\n  [TipologiaVeicolo.SCOOTER]: parseFloat(F1_MAX_SCOT),\n};\n\nconst COSTO_ORARIO_FASCIA2 = {\n  [TipologiaVeicolo.AUTO_PICCOLA]: parseFloat(F2_ORA_APIC),\n  [TipologiaVeicolo.AUTO_MEDIA]: parseFloat(F2_ORA_AMED),\n  [TipologiaVeicolo.AUTO_GRANDE]: parseFloat(F2_ORA_AGRA),\n  [TipologiaVeicolo.SUV_LUSSO]: parseFloat(F2_ORA_ASUV),\n  [TipologiaVeicolo.FURGONE]: parseFloat(F2_ORA_FURG),\n  [TipologiaVeicolo.MOTO]: parseFloat(F2_ORA_MOTO),\n  [TipologiaVeicolo.SCOOTER]: parseFloat(F2_ORA_SCOT),\n};\n\nconst LIMITE_FASCIA2 = {\n  [TipologiaVeicolo.AUTO_PICCOLA]: parseFloat(F2_MAX_APIC),\n  [TipologiaVeicolo.AUTO_MEDIA]: parseFloat(F2_MAX_AMED),\n  [TipologiaVeicolo.AUTO_GRANDE]: parseFloat(F2_MAX_AGRA),\n  [TipologiaVeicolo.SUV_LUSSO]: parseFloat(F2_MAX_ASUV),\n  [TipologiaVeicolo.FURGONE]: parseFloat(F2_MAX_FURG),\n  [TipologiaVeicolo.MOTO]: parseFloat(F2_MAX_MOTO),\n  [TipologiaVeicolo.SCOOTER]: parseFloat(F2_MAX_SCOT),\n};\n\nconst TOLLERANZA_INGRESSO = parseInt(TOL_ING);\nconst TOLLERANZA_ORARIA = parseInt(TOL_ORE);\n\nfunction printInfo(tipologia) {\n  console.log('Tipologia: ' + tipologia);\n  console.log('Tolleranza Ingresso minuti: ' + TOLLERANZA_INGRESSO);\n  console.log('Tolleranza tra ore minuti: ' + TOLLERANZA_ORARIA);\n  console.log('Costo orario Fascia 1 Euro: ' + COSTO_ORARIO_FASCIA1[tipologia]);\n  console.log('Costo orario Fascia 2 Euro: ' + COSTO_ORARIO_FASCIA2[tipologia]);\n  console.log('Limite Fascia 1 Euro: ' + LIMITE_FASCIA1[tipologia]);\n  console.log('Limite Fascia 2 Euro: ' + LIMITE_FASCIA2[tipologia]);\n}\n\nfunction getTotalAmount(costoFascia1, costoFascia2, tipologia) {\n  costoFascia1 = Math.min(costoFascia1, LIMITE_FASCIA1[tipologia]);\n  if (costoFascia1 === LIMITE_FASCIA1[tipologia]) {\n    costoFascia2 = Math.min(costoFascia2, LIMITE_FASCIA2[tipologia]);\n  }\n  return costoFascia1 + costoFascia2;\n}\n\nfunction main(ingresso, uscita, tipologia) {\n  const ingressoTime = new Date(ingresso);\n  const uscitaTime = new Date(uscita);\n  const milliseconds = uscitaTime - ingressoTime;\n  const minutes = (milliseconds) / (1000 * 60);\n  \n  let increase = 0;\n  let costoFascia1 = 0.0;\n  let costoFascia2 = 0.0;\n  let costoTotale = 0.0;\n  let current = ingressoTime;\n\n  if (minutes <= TOLLERANZA_INGRESSO) {\n    return 0.0;\n  }\n\n  while (current < uscitaTime) {\n    const oraCorrente = current.getHours();\n    const prossimoSlot = new Date(current);\n    prossimoSlot.setHours(current.getHours() + 1, current.getMinutes(), 0, 0);\n\n    const fineSlot = prossimoSlot < uscitaTime ? prossimoSlot : uscitaTime;\n    let minutiNelSlot = (fineSlot - current) / 60000; // minuti nel corrente slot\n\n    // Applica tolleranza oraria\n    increase = (minutiNelSlot > TOLLERANZA_ORARIA) ? 1 : 0;\n\n    // Controllo fascia oraria\n    if (oraCorrente >= 7 && oraCorrente < 20) {\n      costoFascia1 += (COSTO_ORARIO_FASCIA1[tipologia] * increase);\n    } else if (oraCorrente >= 20 || oraCorrente < 2) {\n      costoFascia2 += (COSTO_ORARIO_FASCIA2[tipologia] * increase);\n    } else {\n      costoTotale += getTotalAmount(costoFascia1, costoFascia2, tipologia);\n      costoFascia1 = costoFascia2 = 0;\n    }\n    // Aggiorna orario corrente\n    current = fineSlot;\n  }\n  costoTotale += getTotalAmount(costoFascia1, costoFascia2, tipologia);\n  return costoTotale;\n}","params":[{"idRateParam":0,"sorting":1,"name":"F1_ORA_APIC","label":"Fascia 1 Auto piccola a ora","value":"3.00","updated":[2025,1,13,14,27,40],"created":[2025,1,13,14,27,40]},{"idRateParam":0,"sorting":2,"name":"F1_ORA_AMED","label":"Fascia 1 Auto Media a ora","value":"4.00","updated":[2025,1,13,14,29,23],"created":[2025,1,13,14,29,23]},{"idRateParam":0,"sorting":3,"name":"F1_ORA_AGRA","label":"Fascia 1 Auto Grande a ora","value":"4.50","updated":[2025,1,13,14,28,52],"created":[2025,1,13,14,28,52]},{"idRateParam":0,"sorting":4,"name":"F1_ORA_ASUV","label":"Fascia 1 Auto SUV a ora","value":"6.00","updated":[2025,1,13,14,28,8],"created":[2025,1,13,14,28,8]},{"idRateParam":0,"sorting":5,"name":"F1_ORA_FURG","label":"Fascia 1 Furgone a ora","value":"7.00","updated":[2025,1,13,14,26,48],"created":[2025,1,13,14,26,48]},{"idRateParam":0,"sorting":6,"name":"F1_ORA_MOTO","label":"Fascia 1 Moto a ora","value":"3.00","updated":[2025,1,13,16,40,9],"created":[2025,1,13,16,40,9]},{"idRateParam":0,"sorting":7,"name":"F1_ORA_SCOT","label":"Fascia 1 Scooter a ora","value":"3.00","updated":[2025,1,13,16,40,9],"created":[2025,1,13,16,40,9]},{"idRateParam":0,"sorting":8,"name":"F1_MAX_APIC","label":"Fascia 1 Auto piccola a MAX","value":"30.00","updated":[2025,1,13,16,43,50],"created":[2025,1,13,16,43,50]},{"idRateParam":0,"sorting":9,"name":"F1_MAX_AMED","label":"Fascia 1 Auto Media a MAX","value":"30.00","updated":[2025,1,13,16,43,50],"created":[2025,1,13,16,43,50]},{"idRateParam":0,"sorting":10,"name":"F1_MAX_AGRA","label":"Fascia 1 Auto Grande a MAX","value":"35.00","updated":[2025,1,13,16,43,50],"created":[2025,1,13,16,43,50]},{"idRateParam":0,"sorting":11,"name":"F1_MAX_ASUV","label":"Fascia 1 Auto SUV a MAX","value":"35.00","updated":[2025,1,13,16,43,50],"created":[2025,1,13,16,43,50]},{"idRateParam":0,"sorting":12,"name":"F1_MAX_FURG","label":"Fascia 1 Furgone a MAX","value":"40.00","updated":[2025,1,13,16,43,50],"created":[2025,1,13,16,43,50]},{"idRateParam":0,"sorting":13,"name":"F1_MAX_MOTO","label":"Fascia 1 Moto a MAX","value":"30.00","updated":[2025,1,13,16,43,50],"created":[2025,1,13,16,43,50]},{"idRateParam":0,"sorting":14,"name":"F1_MAX_SCOT","label":"Fascia 1 Scooter a MAX","value":"30.00","updated":[2025,1,13,16,43,50],"created":[2025,1,13,16,43,50]},{"idRateParam":0,"sorting":15,"name":"F2_ORA_APIC","label":"Fascia 2 Auto piccola a ora","value":"4.00","updated":[2025,1,13,16,47,15],"created":[2025,1,13,16,47,15]},{"idRateParam":0,"sorting":16,"name":"F2_ORA_AMED","label":"Fascia 2 Auto Media a ora","value":"4.50","updated":[2025,1,13,16,47,15],"created":[2025,1,13,16,47,15]},{"idRateParam":0,"sorting":17,"name":"F2_ORA_AGRA","label":"Fascia 2 Auto Grande a ora","value":"5.00","updated":[2025,1,13,16,47,15],"created":[2025,1,13,16,47,15]},{"idRateParam":0,"sorting":18,"name":"F2_ORA_ASUV","label":"Fascia 2 Auto SUV a ora","value":"7.00","updated":[2025,1,13,16,47,15],"created":[2025,1,13,16,47,15]},{"idRateParam":0,"sorting":19,"name":"F2_ORA_FURG","label":"Fascia 2 Furgone a ora","value":"8.00","updated":[2025,1,13,16,47,15],"created":[2025,1,13,16,47,15]},{"idRateParam":0,"sorting":20,"name":"F2_ORA_MOTO","label":"Fascia 2 Moto a ora","value":"4.00","updated":[2025,1,13,16,47,15],"created":[2025,1,13,16,47,15]},{"idRateParam":0,"sorting":21,"name":"F2_ORA_SCOT","label":"Fascia 2 Scooter a ora","value":"4.00","updated":[2025,1,13,16,47,15],"created":[2025,1,13,16,47,15]},{"idRateParam":0,"sorting":22,"name":"F2_MAX_APIC","label":"Fascia 2 Auto piccola a MAX","value":"10.00","updated":[2025,1,13,16,49,8],"created":[2025,1,13,16,49,8]},{"idRateParam":0,"sorting":23,"name":"F2_MAX_AMED","label":"Fascia 2 Auto Media a MAX","value":"15.00","updated":[2025,1,13,16,52,40],"created":[2025,1,13,16,52,40]},{"idRateParam":0,"sorting":24,"name":"F2_MAX_AGRA","label":"Fascia 2 Auto Grande a MAX","value":"15.00","updated":[2025,1,13,16,52,40],"created":[2025,1,13,16,52,40]},{"idRateParam":0,"sorting":25,"name":"F2_MAX_ASUV","label":"Fascia 2 Auto SUV a MAX","value":"20.00","updated":[2025,1,13,16,52,40],"created":[2025,1,13,16,52,40]},{"idRateParam":0,"sorting":26,"name":"F2_MAX_FURG","label":"Fascia 2 Furgone a MAX","value":"20.00","updated":[2025,1,13,16,52,40],"created":[2025,1,13,16,52,40]},{"idRateParam":0,"sorting":27,"name":"F2_MAX_MOTO","label":"Fascia 2 Moto a MAX","value":"10.00","updated":[2025,1,13,16,52,40],"created":[2025,1,13,16,52,40]},{"idRateParam":0,"sorting":28,"name":"F2_MAX_SCOT","label":"Fascia 2 Scooter a MAX","value":"10.00","updated":[2025,1,13,16,52,40],"created":[2025,1,13,16,52,40]},{"idRateParam":0,"sorting":29,"name":"TOL_ING","label":"Tolleranza Minuti Ingresso","value":"5","updated":[2025,1,13,17,45,32],"created":[2025,1,13,17,45,32]},{"idRateParam":0,"sorting":30,"name":"TOL_ORE","label":"Tolleranza Minuti Ore","value":"10","updated":[2025,1,13,17,45,32],"created":[2025,1,13,17,45,32]}],"updated":[2025,1,15,10,17,30],"created":[2025,1,15,10,17,30],"default":true}